{% extends "base.html" %}

{% block title %}
取引詳細
{% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/transaction_detail.css') }}">

<main class="container">
    <div class="transaction-container">
        
        <!-- 取引情報 -->
        <section class="transaction-info">
            <h2>取引情報</h2>
            
            <div class="product-detail">
                <div class="product-image" role="img" aria-label="商品画像">
                    {% if transaction.image %}
                        <img src="{{ url_for('static', filename='img/' + transaction.image) }}" alt="{{ transaction.name }}">
                    {% else %}
                        <img src="{{ url_for('static', filename='img/noimage.png') }}" alt="No Image">
                    {% endif %}
                </div>
                <div class="product-name">{{ transaction.name }}</div>
            </div>
            
            <div class="info-list">
                <div class="info-row">
                    <div class="info-label">商品代金</div>
                    <div class="info-value">¥{{ "{:,}".format(transaction.price) }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">販売手数料</div>
                    <div class="info-value">¥{{ "{:,}".format(transaction.fee) }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">販売利益</div>
                    <div class="info-value">¥{{ "{:,}".format(transaction.profit) }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">購入日時</div>
                    <div class="info-value">{{ transaction.purchase_date.strftime('%Y年%m月%d日 %H:%M') }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">配送の方法</div>
                    <div class="info-value">{{ transaction.shipping_method }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">商品ID</div>
                    <div class="info-value">{{ transaction.id }}</div>
                </div>
            </div>
        </section>

        <!-- 購入者情報 -->
        <section class="buyer-info">
            <h2>購入者情報</h2>
            
            <a href="{{ url_for('user.profile', username=buyer.username) }}" class="buyer-profile">
                <div class="buyer-left">
                    <div class="buyer-avatar">
                        {% if buyer.avatar %}
                            <img src="{{ url_for('static', filename='img/' + buyer.avatar) }}" alt="{{ buyer.username }}">
                        {% else %}
                            <img src="{{ url_for('static', filename='img/default_user.png') }}" alt="No Avatar">
                        {% endif %}
                    </div>
                    <div class="buyer-name-rating">
                        <div class="buyer-name">{{ buyer.username }}</div>
                        <div class="rating-badges">
                            <span class="rating-star">{{ '⭐' * buyer.rating }}</span>
                            <span class="rating-count">{{ buyer.review_count }}</span>
                            {% if buyer.verified %}
                                <span class="badge-verified">本人確認済</span>
                            {% endif %}
                            {% if buyer.other_info %}
                                <span class="badge-other">{{ buyer.other_info }}</span>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="list-item-arrow">&gt;</div>
            </a>
        </section>
        
    </div>
</main>
{% endblock %}
